# Pre-commit Validation
#
# Component workflow that validates pre-commit hooks.
# Can be called from other workflows or run manually.
#
# Inputs:
#   ref: Git reference to check out (required)
#
# Usage:
#   Called by pull-request-default.yml for PR validation

name: Pre-commit Validation

on:
  workflow_call:
    inputs:
      ref:
        description: 'Git reference to check out'
        required: true
        type: string

jobs:
  validate-hooks:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          ref: ${{ inputs.ref }}
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'
      
      - name: Cache pre-commit environments
        uses: actions/cache@v4
        with:
          path: ~/.cache/pre-commit
          key: pre-commit-${{ hashFiles('.pre-commit-config.yaml') }}
      
      - name: Install pre-commit
        run: pip install pre-commit
      
      - name: Run pre-commit hooks
        run: pre-commit run --all-files
